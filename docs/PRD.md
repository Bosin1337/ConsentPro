## Техническое Задание: Telegram-бот для Учета Согласий Родителей

**1. Введение**

Данное техническое задание описывает требования к разработке Telegram-бота для учета и отслеживания согласий родителей на участие детей в различных школьных мероприятиях. Бот предназначен для автоматизации процесса сбора и анализа согласий, снижения нагрузки на учителей и обеспечения прозрачности для родителей через платформу Telegram.

**2. Цели и задачи проекта**

*   Автоматизация процесса загрузки, сбора и учета согласий родителей через Telegram-бота.
*   Обеспечение удобного интерфейса в Telegram для учителей по управлению согласиями и списками учеников.
*   Предоставление родителям возможности загрузки подписанных документов и отслеживания статуса согласий через Telegram.
*   Автоматическое определение статуса согласия с помощью ИИ.
*   Формирование отчетов для учителей и администраторов.
*   Уведомление пользователей о важных событиях через Telegram.

**3. Пользователи и роли**

Система предусматривает следующие роли пользователей, взаимодействующих с Telegram-ботом:

*   **Администратор:**
    *   Полный доступ ко всем функциям системы через Telegram-бота.
    *   Управление учителями, классами и общими настройками системы через набор административных команд.
    *   Доступ ко всем отчетам через бота.
*   **Учитель:**
    *   Создание и управление классами и списками учеников через команды бота.
    *   Добавление и редактирование информации о родителях (только ФИО), привязка их к ученикам через команды бота.
    *   Загрузка PDF/DOCX-файлов согласий для мероприятий через бота.
    *   Просмотр статусов согласий по каждому ученику через бота.
    *   Получение сводки от ИИ по результатам сбора согласий после дедлайна через бота.
    *   Получение уведомлений о приближении сроков сдачи согласий через бота.
    *   Доступ к отчетам по своим классам через бота.
    *   Взаимодействие с ИИ: возможность задавать ИИ вопросы по статусам согласий и получать помощь в отметке статусов через чат с ботом.
*   **Родитель:**
    *   Просмотр списка согласий, относящихся к его ребенку, через бота.
    *   Загрузка подписанных PDF/DOCX-файлов согласий в ответ на запрос бота.
    *   Получение уведомлений о новых согласиях или о необходимости сдать согласие через бота.
    *   Доступа к ИИ нет.

**4. Функциональные требования**

**4.1. Управление пользователями и ролями**

*   Бот должен поддерживать роли: Администратор, Учитель, Родитель.
*   Функциональность регистрации и авторизации пользователей через Telegram (например, по уникальному коду или подтверждению администратором/учителем).
*   Администратор должен иметь возможность управлять учетными записями учителей и их привязкой к классам через команды бота.
*   Учитель должен иметь возможность управлять учетными записями родителей (только ФИО) и привязывать их к ученикам через команды бота.

**4.2. Управление классами и учениками (для Учителя)**

*   Учитель должен иметь возможность создавать классы через команды бота.
*   Учитель должен иметь возможность добавлять учеников в классы (ФИО, класс) через команды бота.
*   Учитель должен иметь возможность вносить данные о родителях (только ФИО) и привязывать их к ученикам через команды бота.

**4.3. Управление согласиями**

*   **Загрузка согласий (для Учителя):**
    *   Учитель может загружать PDF и DOCX файлы согласий через бота.
    *   Максимальный размер файла: 10 МБ.
    *   Возможность установки конечной даты (дедлайна) для сдачи согласия через бота.
*   **Просмотр согласий (для Учителя и Родителя):**
    *   Бот должен предоставлять ссылки на загруженные PDF/DOCX файлы или возможность их скачивания.
    *   Родитель видит только согласия, относящиеся к его ребенку.
*   **Загрузка подписанных согласий (для Родителя):**
    *   Родитель может загружать подписанные PDF/DOCX файлы в ответ на запрос бота.
*   **Хранение файлов:**
    *   Все загруженные файлы (исходные согласия от учителя и подписанные от родителей) должны храниться на сервере приложения.

**4.4. Статусы согласий и ИИ**

*   **Статусы:** Согласие может иметь следующие статусы: "Сдано", "Не сдано", "Отказался", "Не идет".
*   **Автоматическое определение статуса ИИ:**
    *   ИИ должен анализировать загруженные родителями документы (PDF/DOCX) и автоматически определять статус согласия: "Сдано" (согласие дано), "Не сдано" (документ не загружен), "Отказался" (в документе указан отказ), "Не идет" (в документе указано, что ребенок не пойдет).
    *   ИИ для учителя: Возможность задавать ИИ вопросы по статусам согласий и получать помощь в отметке статусов через чат с ботом.

**4.5. Конечная дата согласий**

*   После наступления конечной даты, установленной учителем, согласие автоматически становится неактивным для изменений и получает статус "Просрочено".
*   После наступления конечной даты ИИ должен автоматически формировать и отправлять учителю сводку по всем ученикам, где указаны должники, отказы и согласия, через бота.

**4.6. Уведомления**

*   **Уведомления учителям:**
    *   О приближении сроков сдачи согласий (через бота).
    *   Сводка от ИИ после окончания срока сдачи (через бота).
*   **Уведомления родителям:**
    *   О новых согласиях, требующих их внимания (через бота).
    *   О необходимости сдать согласие (напоминания, через бота).

**4.7. Отчетность**

*   Бот должен предоставлять возможность формирования отчетов для учителей и администраторов через команды бота.
*   Примеры отчетов:
    *   Список учеников по статусам согласий (сдано, не сдано, отказался, не идет).
    *   Статистика сдачи согласий по классам.

**5. Интерфейс Telegram-бота (примеры команд)**

*   `/start` - Начало работы с ботом, авторизация.
*   `/my_classes` - Учитель: просмотр списка своих классов.
*   `/add_class <Название класса>` - Учитель: создание нового класса.
*   `/add_student <Класс> <ФИО ученика> <ФИО родителя>` - Учитель: добавление ученика и привязка родителя.
*   `/upload_consent <Класс> <Название согласия> <Дата окончания>` - Учитель: загрузка PDF/DOCX согласия.
*   `/my_consents` - Родитель: просмотр списка согласий для ребенка.
*   `/submit_consent <ID согласия>` - Родитель: загрузка подписанного документа.
*   `/ask_ai <Вопрос>` - Учитель: задать вопрос ИИ.
*   `/reports` - Учитель/Администратор: запросить отчеты.

**6. Технологический стек**

*   **Платформа бота:** Telegram Bot API
*   **Язык программирования:** Python (рекомендуется)
*   **Фреймворк для бота:** `python-telegram-bot` (рекомендуется)
*   **База данных:** PostgreSQL (рекомендуется)
*   **Хостинг:** На усмотрение разработчика (например, облачные платформы с поддержкой Python и PostgreSQL).
*   **Пакетный менеджер:** pip
*   **ИИ для анализа документов:** Библиотека для обработки PDF/DOCX и извлечения текста, а также для анализа текста (например, на основе NLP).

**7. Нефункциональные требования**

*   **Производительность:** Бот должен быстро обрабатывать запросы и отвечать пользователям.
*   **Надежность:** Бот должен быть стабильным, устойчивым к сбоям и потере сообщений.
*   **Безопасность:** Должны быть реализованы механизмы защиты данных пользователей и конфиденциальной информации.
*   **Масштабируемость:** Архитектура бота должна предусматривать возможность увеличения нагрузки и добавления нового функционала.
*   **Удобство использования (UX):** Взаимодействие с ботом должно быть интуитивно понятным и удобным для всех категорий пользователей, с использованием кнопок и меню Telegram.

**8. Открытые вопросы (для дальнейшего уточнения при разработке):**

*   Какие конкретно типы вопросов ИИ для учителя должен уметь обрабатывать? (например, "Сколько учеников не сдали согласие?", "Кто отказался от участия в экскурсии?")
*   Какие дополнительные фильтры или опции сортировки будут полезны в отчетах? (Например, по дате создания согласия, по классу, по статусу).
*   Какой механизм авторизации/регистрации пользователей будет использоваться (например, по уникальному коду, выдаваемому учителем/администратором, или по номеру телефона/email, подтверждаемому через бота)?